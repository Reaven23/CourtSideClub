<%= turbo_frame_tag 'admin_content' do %>
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="h5 mb-0"><%= t('vote_campaigns.admin.campaign_details', title: @vote_campaign.title) %></h2>
    <%= link_to t('vote_campaigns.admin.back_to_dashboard'), admin_dashboard_path(tab: 'votes'), class: 'btn btn-outline-secondary btn-sm' %>
  </div>

  <div class="row g-3">
    <div class="col-12 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h6 class="mb-0"><%= t('vote_campaigns.admin.general_info') %></h6>
        </div>
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-sm-4"><%= t('vote_campaigns.admin.title') %></dt>
            <dd class="col-sm-8"><%= @vote_campaign.title %></dd>

            <dt class="col-sm-4"><%= t('vote_campaigns.admin.description') %></dt>
            <dd class="col-sm-8"><%= @vote_campaign.description %></dd>

            <dt class="col-sm-4"><%= t('vote_campaigns.admin.start_date') %></dt>
            <dd class="col-sm-8"><%= @vote_campaign.start_date&.strftime('%d/%m/%Y à %H:%M') %></dd>

            <dt class="col-sm-4"><%= t('vote_campaigns.admin.end_date') %></dt>
            <dd class="col-sm-8"><%= @vote_campaign.end_date&.strftime('%d/%m/%Y à %H:%M') %></dd>

            <dt class="col-sm-4"><%= t('vote_campaigns.admin.status') %></dt>
            <dd class="col-sm-8">
              <% if @vote_campaign.active? %>
                <span class="badge bg-success"><%= t('vote_campaigns.admin.active') %></span>
              <% else %>
                <span class="badge bg-secondary"><%= t('vote_campaigns.admin.inactive') %></span>
              <% end %>
            </dd>

            <dt class="col-sm-4"><%= t('vote_campaigns.admin.total_votes') %></dt>
            <dd class="col-sm-8"><%= @vote_campaign.vote_count %></dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-12 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h6 class="mb-0"><%= t('vote_campaigns.admin.participating_players', count: @vote_campaign.players.count) %></h6>
        </div>
        <div class="card-body">
          <% if @vote_campaign.players.any? %>
            <div class="list-group list-group-flush">
              <% @vote_campaign.players.each do |player| %>
                <div class="list-group-item d-flex justify-content-between align-items-center">
                  <div class="d-flex align-items-center">
                    <% if player.photo.attached? %>
                      <% if Rails.env.production? %>
                        <%= cl_image_tag player.photo.key, class: 'rounded-circle me-3', style: 'width: 40px; height: 40px; object-fit: cover;', width: 40, height: 40, crop: :fill, gravity: :face %>
                      <% else %>
                        <%= image_tag player.photo, class: 'rounded-circle me-3', style: 'width: 40px; height: 40px; object-fit: cover;' %>
                      <% end %>
                    <% else %>
                      <div class="rounded-circle me-3 d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; background: linear-gradient(45deg, #EE53A8, #8a2be2); color: white; font-weight: bold;">
                        <%= player.first_name[0] %>
                      </div>
                    <% end %>
                    <div>
                      <div class="fw-semibold"><%= player.full_name %></div>
                      <div class="text-muted small"><%= t('vote_campaigns.admin.tournaments_played', count: player.tournament_played) %></div>
                    </div>
                  </div>
                  <div class="text-end">
                    <span class="badge bg-primary"><%= @vote_campaign.vote_count_for_player(player) %> <%= t('vote_campaigns.stats.votes') %></span>
                  </div>
                </div>
              <% end %>
            </div>
          <% else %>
            <p class="text-muted mb-0"><%= t('vote_campaigns.admin.no_players') %></p>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-3">
    <div class="d-flex gap-2">
      <%= link_to t('vote_campaigns.admin.edit'), edit_admin_vote_campaign_path(@vote_campaign), class: 'btn btn-outline-primary', data: { turbo_frame: 'admin_content' } %>
      <%= link_to t('vote_campaigns.admin.delete'), admin_vote_campaign_path(@vote_campaign), data: { turbo_method: :delete, turbo_confirm: t('vote_campaigns.admin.delete_confirm') }, class: 'btn btn-danger' %>
    </div>
  </div>
<% end %>
